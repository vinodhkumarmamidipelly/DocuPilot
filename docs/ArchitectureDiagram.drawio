{
  "diagram": {
    "title": "SMEPilot Architecture Diagram",
    "elements": [
      {
        "type": "User",
        "label": "User (Employee / Admin)"
      },
      {
        "type": "SharePoint",
        "label": "SharePoint Library (ScratchDocs)"
      },
      {
        "type": "Azure Function",
        "label": "Azure Function - ProcessSharePointFile"
      },
      {
        "type": "Azure OpenAI",
        "label": "Azure OpenAI (GPT + Embeddings)"
      },
      {
        "type": "Cosmos DB",
        "label": "Cosmos DB (Embeddings Store)"
      },
      {
        "type": "SharePoint",
        "label": "ProcessedDocs Library"
      },
      {
        "type": "Teams / Copilot",
        "label": "Teams / Copilot"
      },
      {
        "connections": [
          [
            "User",
            "SharePoint Library (ScratchDocs)",
            "Upload Doc"
          ],
          [
            "SharePoint Library (ScratchDocs)",
            "Azure Function - ProcessSharePointFile",
            "Trigger via Graph"
          ],
          [
            "Azure Function - ProcessSharePointFile",
            "Azure OpenAI (GPT + Embeddings)",
            "Enrich Content"
          ],
          [
            "Azure Function - ProcessSharePointFile",
            "Cosmos DB (Embeddings Store)",
            "Store Embeddings"
          ],
          [
            "Azure Function - ProcessSharePointFile",
            "ProcessedDocs Library",
            "Upload Enriched Doc"
          ],
          [
            "Teams / Copilot",
            "ProcessedDocs Library",
            "Query / Search"
          ]
        ]
      }
    ]
  }
}