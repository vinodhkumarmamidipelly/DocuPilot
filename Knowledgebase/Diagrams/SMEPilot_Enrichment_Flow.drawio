<mxfile host="app.diagrams.net" modified="2024-01-01T00:00:00.000Z" agent="5.0" version="21.0.0" etag="flow-complete-v4" type="device">
  <diagram name="SMEPilot Complete Flow" id="flow-complete-v4">
    <mxGraphModel dx="2000" dy="2200" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="2400" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- Title -->
        <mxCell id="title" value="SMEPilot - Complete Process Flow" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=32;fontStyle=1;fontColor=#1a1a1a" vertex="1" parent="1">
          <mxGeometry x="400" y="20" width="800" height="50" as="geometry" />
        </mxCell>
        
        <!-- Installation Phase -->
        <mxCell id="install-phase" value="ðŸ”§ INSTALLATION PHASE" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff3e0;strokeColor=#e65100;strokeWidth=4;fontSize=20;fontStyle=1;align=center;verticalAlign=middle" vertex="1" parent="1">
          <mxGeometry x="500" y="90" width="600" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="install-step1" value="Admin Installs App in SharePoint" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff9c4;strokeColor=#f57f17;strokeWidth=3;fontSize=14;fontStyle=1;align=center;verticalAlign=top;spacingTop=15" vertex="1" parent="1">
          <mxGeometry x="500" y="170" width="600" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="install-step2" value="SPFx Admin Panel Opens&#xa;All Configurations Required (6 Items):" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff9c4;strokeColor=#f57f17;strokeWidth=3;fontSize=14;fontStyle=1;align=center;verticalAlign=top;spacingTop=15" vertex="1" parent="1">
          <mxGeometry x="500" y="280" width="600" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="install-config-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;strokeWidth=2;dashed=0" vertex="1" parent="1">
          <mxGeometry x="300" y="390" width="1000" height="200" as="geometry" />
        </mxCell>
        
        <mxCell id="config-title" value="Installation-Time Configurations (6 Items)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1;fontColor=#1a1a1a" vertex="1" parent="1">
          <mxGeometry x="600" y="410" width="400" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="config1" value="ðŸ“ Source Folder&#xa;(User Selected)&#xa;/Shared Documents/RawDocs" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#01579b;strokeWidth=2;fontSize=12;align=center;verticalAlign=top;spacingTop=10" vertex="1" parent="1">
          <mxGeometry x="330" y="470" width="180" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="config2" value="ðŸ“ Destination Folder&#xa;(User Selected)&#xa;/Shared Documents/EnrichedDocs" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#01579b;strokeWidth=2;fontSize=12;align=center;verticalAlign=top;spacingTop=10" vertex="1" parent="1">
          <mxGeometry x="540" y="470" width="180" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="config3" value="ðŸ“„ Template File&#xa;UniversalOrgTemplate.dotx" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#01579b;strokeWidth=2;fontSize=12;align=center;verticalAlign=top;spacingTop=10" vertex="1" parent="1">
          <mxGeometry x="750" y="470" width="180" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="config4" value="âš™ï¸ Processing Settings&#xa;Max: 50MB, Timeout: 60s&#xa;Retries: 3" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#01579b;strokeWidth=2;fontSize=12;align=center;verticalAlign=top;spacingTop=10" vertex="1" parent="1">
          <mxGeometry x="960" y="470" width="180" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="config5" value="ðŸ¤– Copilot Agent Prompt&#xa;Custom Instructions&#xa;(Always Enabled)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fce4ec;strokeColor=#c2185b;strokeWidth=2;fontSize=12;align=center;verticalAlign=top;spacingTop=10" vertex="1" parent="1">
          <mxGeometry x="330" y="570" width="180" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="config6" value="ðŸ“ Access Points&#xa;Teams/Web/O365&#xa;(Configurable)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fce4ec;strokeColor=#c2185b;strokeWidth=2;fontSize=12;align=center;verticalAlign=top;spacingTop=10" vertex="1" parent="1">
          <mxGeometry x="540" y="570" width="180" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="install-step3" value="âœ… Configuration Validated &amp; Saved to SMEPilotConfig List" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=3;fontSize=14;fontStyle=1;align=center;verticalAlign=top;spacingTop=15" vertex="1" parent="1">
          <mxGeometry x="500" y="620" width="600" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="install-step4" value="âœ… Webhook Subscription Created&#xa;âœ… Metadata Columns Created&#xa;âœ… Both Functionalities Ready (Copilot Agent Always Enabled)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=3;fontSize=14;fontStyle=1;align=center;verticalAlign=top;spacingTop=15" vertex="1" parent="1">
          <mxGeometry x="500" y="730" width="600" height="100" as="geometry" />
        </mxCell>
        
        <!-- Runtime Phase -->
        <mxCell id="runtime-phase" value="ðŸ”„ RUNTIME PHASE - Document Enrichment Flow" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e3f2fd;strokeColor=#1565c0;strokeWidth=4;fontSize=20;fontStyle=1;align=center;verticalAlign=middle" vertex="1" parent="1">
          <mxGeometry x="500" y="860" width="600" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="step1" value="STEP 1: User Uploads Document&#xa;&#xa;Business user uploads .docx file&#xa;to configured Source Folder (user-selected)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=3;fontSize=14;fontStyle=1;align=center;verticalAlign=top;spacingTop=15" vertex="1" parent="1">
          <mxGeometry x="500" y="940" width="600" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="step2" value="STEP 2: Webhook Notification&#xa;&#xa;SharePoint sends Graph Webhook&#xa;to Function App /api/ProcessSharePointFile" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff9c4;strokeColor=#f57f17;strokeWidth=3;fontSize=14;fontStyle=1;align=center;verticalAlign=top;spacingTop=15" vertex="1" parent="1">
          <mxGeometry x="500" y="1070" width="600" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="step3" value="STEP 3: Function App Receives&#xa;&#xa;ProcessSharePointFile validates&#xa;and processes notification" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=3;fontSize=14;fontStyle=1;align=center;verticalAlign=top;spacingTop=15" vertex="1" parent="1">
          <mxGeometry x="500" y="1200" width="600" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="decision1" value="Already Processed?&#xa;(SMEPilot_Enriched = Yes?)" style="rhombus;whiteSpace=wrap;html=1;fillColor=#ffcdd2;strokeColor=#c62828;strokeWidth=2;fontSize=13;fontStyle=1;align=center" vertex="1" parent="1">
          <mxGeometry x="550" y="1330" width="300" height="120" as="geometry" />
        </mxCell>
        
        <mxCell id="skip" value="âœ… Skip Processing&#xa;(Idempotent Operation)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;strokeWidth=2;fontSize=12;align=center" vertex="1" parent="1">
          <mxGeometry x="900" y="1350" width="200" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="step4" value="STEP 4: Download File&#xa;&#xa;GraphHelper downloads file&#xa;from SharePoint via Graph API" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#2e7d32;strokeWidth=3;fontSize=14;fontStyle=1;align=center;verticalAlign=top;spacingTop=15" vertex="1" parent="1">
          <mxGeometry x="500" y="1480" width="600" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="decision2" value="File Valid?&#xa;(Size â‰¤50MB, Format .docx)" style="rhombus;whiteSpace=wrap;html=1;fillColor=#ffcdd2;strokeColor=#c62828;strokeWidth=2;fontSize=13;fontStyle=1;align=center" vertex="1" parent="1">
          <mxGeometry x="550" y="1610" width="300" height="120" as="geometry" />
        </mxCell>
        
        <mxCell id="reject" value="âŒ Move to RejectedDocs&#xa;Update metadata:&#xa;SMEPilot_Status = Rejected" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffcdd2;strokeColor=#c62828;strokeWidth=2;fontSize=12;align=center" vertex="1" parent="1">
          <mxGeometry x="900" y="1630" width="200" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="step5" value="STEP 5: Read Configuration&#xa;&#xa;Read from SMEPilotConfig list:&#xa;â€¢ Template path&#xa;â€¢ Destination folder (user-selected)&#xa;â€¢ Processing settings" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1bee7;strokeColor=#6a1b9a;strokeWidth=3;fontSize=14;fontStyle=1;align=center;verticalAlign=top;spacingTop=15" vertex="1" parent="1">
          <mxGeometry x="500" y="1760" width="600" height="120" as="geometry" />
        </mxCell>
        
        <mxCell id="step6" value="STEP 6: Get Template&#xa;&#xa;Download template file&#xa;from Templates library" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#2e7d32;strokeWidth=3;fontSize=14;fontStyle=1;align=center;verticalAlign=top;spacingTop=15" vertex="1" parent="1">
          <mxGeometry x="500" y="1910" width="600" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="step7" value="STEP 7: Enrich Document&#xa;&#xa;DocumentEnricherService processes (Rule-Based, NO AI):&#xa;â€¢ Parse content (OpenXML, third-party libs OK)&#xa;â€¢ Map to template sections (Overview, Functional, Technical, Troubleshooting, Revision)&#xa;â€¢ Insert images&#xa;â€¢ Expand revision table&#xa;â€¢ Insert TOC field" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=3;fontSize=13;fontStyle=1;align=left;verticalAlign=top;spacingLeft=15;spacingTop=15" vertex="1" parent="1">
          <mxGeometry x="500" y="2040" width="600" height="150" as="geometry" />
        </mxCell>
        
        <mxCell id="decision3" value="Enrichment&#xa;Successful?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#ffcdd2;strokeColor=#c62828;strokeWidth=2;fontSize=13;fontStyle=1;align=center" vertex="1" parent="1">
          <mxGeometry x="550" y="2220" width="300" height="120" as="geometry" />
        </mxCell>
        
        <mxCell id="failed" value="âŒ Move to FailedDocs&#xa;Update metadata:&#xa;SMEPilot_Status = Failed&#xa;Log error" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffcdd2;strokeColor=#c62828;strokeWidth=2;fontSize=12;align=center" vertex="1" parent="1">
          <mxGeometry x="100" y="2240" width="200" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="step8" value="STEP 8: Upload Enriched Document&#xa;&#xa;Upload to:&#xa;ðŸ“ Destination Folder (user-selected during installation)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1f5ff;strokeColor=#01579b;strokeWidth=3;fontSize=14;fontStyle=1;align=center;verticalAlign=top;spacingTop=15" vertex="1" parent="1">
          <mxGeometry x="500" y="2380" width="600" height="120" as="geometry" />
        </mxCell>
        
        <mxCell id="step9" value="STEP 9: Update Metadata&#xa;&#xa;Update source document:&#xa;â€¢ SMEPilot_Enriched = Yes&#xa;â€¢ SMEPilot_Status = Enriched&#xa;â€¢ SMEPilot_EnrichedFileUrl = Link to enriched file&#xa;â€¢ SMEPilot_ProcessedDate = Current date" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1bee7;strokeColor=#6a1b9a;strokeWidth=3;fontSize=13;fontStyle=1;align=left;verticalAlign=top;spacingLeft=15;spacingTop=15" vertex="1" parent="1">
          <mxGeometry x="500" y="2530" width="600" height="130" as="geometry" />
        </mxCell>
        
        <mxCell id="step10" value="STEP 10: Index for Copilot Agent&#xa;&#xa;Microsoft Search indexes&#xa;enriched document in Destination Folder&#xa;Ready for Copilot Agent queries" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e8eaf6;strokeColor=#3f51b5;strokeWidth=3;fontSize=14;fontStyle=1;align=center;verticalAlign=top;spacingTop=15" vertex="1" parent="1">
          <mxGeometry x="500" y="2690" width="600" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="success" value="âœ… SUCCESS&#xa;&#xa;Document enriched and indexed&#xa;Both functionalities working:&#xa;1. Document Enrichment âœ…&#xa;2. Copilot Agent âœ… (Always Enabled)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=4;fontSize=16;fontStyle=1;align=center;verticalAlign=top;spacingTop=20" vertex="1" parent="1">
          <mxGeometry x="500" y="2820" width="600" height="140" as="geometry" />
        </mxCell>
        
        <!-- Arrows -->
        <mxCell id="arrow1" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=3;strokeColor=#f57f17" edge="1" parent="1" source="install-step1" target="install-step2">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="800" y="400" as="sourcePoint" />
            <mxPoint x="850" y="350" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow2" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=3;strokeColor=#f57f17" edge="1" parent="1" source="install-step2" target="install-config-box">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="800" y="400" as="sourcePoint" />
            <mxPoint x="850" y="350" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow3" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=3;strokeColor=#82b366" edge="1" parent="1" source="install-config-box" target="install-step3">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="800" y="800" as="sourcePoint" />
            <mxPoint x="850" y="750" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow4" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=3;strokeColor=#82b366" edge="1" parent="1" source="install-step3" target="install-step4">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="800" y="900" as="sourcePoint" />
            <mxPoint x="850" y="850" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow5" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=4;strokeColor=#1565c0" edge="1" parent="1" source="install-step4" target="runtime-phase">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="800" y="1000" as="sourcePoint" />
            <mxPoint x="850" y="950" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow6" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=3;strokeColor=#82b366" edge="1" parent="1" source="step1" target="step2">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="800" y="1200" as="sourcePoint" />
            <mxPoint x="850" y="1150" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow7" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=3;strokeColor=#f57f17" edge="1" parent="1" source="step2" target="step3">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="800" y="1300" as="sourcePoint" />
            <mxPoint x="850" y="1250" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow8" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=3;strokeColor=#6c8ebf" edge="1" parent="1" source="step3" target="decision1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="800" y="1400" as="sourcePoint" />
            <mxPoint x="850" y="1350" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow9" value="Yes" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#9673a6;fontSize=12;fontColor=#6a1b9a" edge="1" parent="1" source="decision1" target="skip">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="800" y="1500" as="sourcePoint" />
            <mxPoint x="850" y="1450" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow10" value="No" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=3;strokeColor=#2e7d32;fontSize=12;fontColor=#1b5e20" edge="1" parent="1" source="decision1" target="step4">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="800" y="1600" as="sourcePoint" />
            <mxPoint x="850" y="1550" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow11" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=3;strokeColor=#2e7d32" edge="1" parent="1" source="step4" target="decision2">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="800" y="1700" as="sourcePoint" />
            <mxPoint x="850" y="1650" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow12" value="Invalid" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#c62828;fontSize=12;fontColor=#b71c1c" edge="1" parent="1" source="decision2" target="reject">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="800" y="1800" as="sourcePoint" />
            <mxPoint x="850" y="1750" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow13" value="Valid" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=3;strokeColor=#6a1b9a;fontSize=12;fontColor=#4a148c" edge="1" parent="1" source="decision2" target="step5">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="800" y="1900" as="sourcePoint" />
            <mxPoint x="850" y="1850" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow14" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=3;strokeColor=#2e7d32" edge="1" parent="1" source="step5" target="step6">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="800" y="2000" as="sourcePoint" />
            <mxPoint x="850" y="1950" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow15" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=3;strokeColor=#6c8ebf" edge="1" parent="1" source="step6" target="step7">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="800" y="2100" as="sourcePoint" />
            <mxPoint x="850" y="2050" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow16" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=3;strokeColor=#6c8ebf" edge="1" parent="1" source="step7" target="decision3">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="800" y="2300" as="sourcePoint" />
            <mxPoint x="850" y="2250" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow17" value="Error" style="endArrow=classic;html=1;rounded=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#c62828;fontSize=12;fontColor=#b71c1c;dashed=1" edge="1" parent="1" source="decision3" target="failed">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="800" y="2400" as="sourcePoint" />
            <mxPoint x="850" y="2350" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow18" value="Success" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=3;strokeColor=#01579b;fontSize=12;fontColor=#01579b" edge="1" parent="1" source="decision3" target="step8">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="800" y="2500" as="sourcePoint" />
            <mxPoint x="850" y="2450" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow19" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=3;strokeColor=#6a1b9a" edge="1" parent="1" source="step8" target="step9">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="800" y="2600" as="sourcePoint" />
            <mxPoint x="850" y="2550" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow20" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=3;strokeColor=#3f51b5" edge="1" parent="1" source="step9" target="step10">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="800" y="2800" as="sourcePoint" />
            <mxPoint x="850" y="2750" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow21" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=4;strokeColor=#82b366" edge="1" parent="1" source="step10" target="success">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="800" y="2900" as="sourcePoint" />
            <mxPoint x="850" y="2850" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- Edge Cases Note -->
        <mxCell id="edge-note" value="âš ï¸ Edge Cases Handled: Large files, Unsupported formats, Corrupted files, Duplicates (idempotency), Concurrent processing (locks), File locked (retry 3x), Network failures (retry with backoff), Template missing, Permission denied" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff3e0;strokeColor=#e65100;strokeWidth=2;fontSize=11;align=left;verticalAlign=top;spacingLeft=10;spacingTop=10" vertex="1" parent="1">
          <mxGeometry x="50" y="100" width="300" height="180" as="geometry" />
        </mxCell>
        
        <!-- Permissions Note -->
        <mxCell id="perm-note" value="ðŸ” Permissions: Minimal required - Sites.ReadWrite.All, Files.ReadWrite.All (App-Only) | End Users: Read access to Destination Folder" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff9c4;strokeColor=#f57f17;strokeWidth=2;fontSize=11;align=left;verticalAlign=top;spacingLeft=10;spacingTop=10" vertex="1" parent="1">
          <mxGeometry x="1250" y="100" width="300" height="100" as="geometry" />
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
