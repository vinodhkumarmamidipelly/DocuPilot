<mxfile host="app.diagrams.net" modified="2024-01-01T00:00:00.000Z" agent="5.0" version="21.0.0" etag="copilot-v2" type="device">
  <diagram name="Copilot Query Flow" id="copilot-flow-v2">
    <mxGraphModel dx="1200" dy="800" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1000" pageHeight="900" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- Title -->
        <mxCell id="title" value="O365 Copilot Query Flow" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;fontStyle=1;fontColor=#1a1a1a" vertex="1" parent="1">
          <mxGeometry x="250" y="20" width="500" height="40" as="geometry" />
        </mxCell>
        
        <!-- Step 1: User Query -->
        <mxCell id="step1" value="STEP 1: User Query&#xa;&#xa;User asks question in Teams:&#xa;&quot;How do I configure alerts?&quot;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=3;fontSize=14;fontStyle=1;align=center;verticalAlign=top;spacingTop=15" vertex="1" parent="1">
          <mxGeometry x="300" y="80" width="400" height="120" as="geometry" />
        </mxCell>
        
        <!-- Step 2: Copilot -->
        <mxCell id="step2" value="STEP 2: O365 Copilot Agent&#xa;&#xa;SMEPilot Knowledge Assistant&#xa;Applies custom instructions:&#xa;â€¢ Use only SMEPilot Enriched Docs&#xa;â€¢ Provide summary + numbered steps&#xa;â€¢ Always cite document title + link" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffcdd2;strokeColor=#c62828;strokeWidth=3;fontSize=13;fontStyle=1;align=left;verticalAlign=top;spacingLeft=15;spacingTop=15" vertex="1" parent="1">
          <mxGeometry x="300" y="240" width="400" height="140" as="geometry" />
        </mxCell>
        
        <!-- Step 3: Search -->
        <mxCell id="step3" value="STEP 3: Microsoft Search&#xa;&#xa;Queries SharePoint Search Index&#xa;for relevant documents" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1bee7;strokeColor=#6a1b9a;strokeWidth=3;fontSize=14;fontStyle=1;align=center;verticalAlign=top;spacingTop=15" vertex="1" parent="1">
          <mxGeometry x="300" y="420" width="400" height="100" as="geometry" />
        </mxCell>
        
        <!-- Step 4: Library -->
        <mxCell id="step4" value="STEP 4: SMEPilot Enriched Docs Library&#xa;&#xa;ðŸ” Indexed Documents&#xa;Search returns relevant enriched documents" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=3;fontSize=14;fontStyle=1;align=center;verticalAlign=top;spacingTop=15" vertex="1" parent="1">
          <mxGeometry x="300" y="560" width="400" height="120" as="geometry" />
        </mxCell>
        
        <!-- Step 5: Response -->
        <mxCell id="step5" value="STEP 5: Formatted Response&#xa;&#xa;Copilot formats answer:&#xa;â€¢ Short summary (2-3 lines)&#xa;â€¢ Numbered step list&#xa;â€¢ Citations (document title + link)&#xa;â€¢ Uncertainty message if needed" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=3;fontSize=13;fontStyle=1;align=left;verticalAlign=top;spacingLeft=15;spacingTop=15" vertex="1" parent="1">
          <mxGeometry x="300" y="720" width="400" height="140" as="geometry" />
        </mxCell>
        
        <!-- Important Note -->
        <mxCell id="note" value="âš ï¸ CRITICAL: NO Function App Involvement&#xa;O365 Copilot queries SharePoint directly via Microsoft Search&#xa;Function App only handles document enrichment, NOT queries" style="text;html=1;strokeColor=#f57f17;fillColor=#fff9c4;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontStyle=2;fontColor=#e65100;fontSize=12" vertex="1" parent="1">
          <mxGeometry x="50" y="420" width="200" height="100" as="geometry" />
        </mxCell>
        
        <!-- Arrows -->
        <mxCell id="arrow1" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=3;strokeColor=#82b366" edge="1" parent="1" source="step1" target="step2">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="500" y="300" as="sourcePoint" />
            <mxPoint x="550" y="250" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow2" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=3;strokeColor=#c62828" edge="1" parent="1" source="step2" target="step3">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="500" y="300" as="sourcePoint" />
            <mxPoint x="550" y="250" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow3" value="Query" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=3;strokeColor=#6a1b9a;fontSize=12;fontColor=#4a148c" edge="1" parent="1" source="step3" target="step4">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="500" y="300" as="sourcePoint" />
            <mxPoint x="550" y="250" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow4" value="Results" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=3;strokeColor=#6c8ebf;fontSize=12;fontColor=#1565c0" edge="1" parent="1" source="step4" target="step5">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="500" y="300" as="sourcePoint" />
            <mxPoint x="650" y="250" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow5" value="Answer" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=3;strokeColor=#82b366;fontSize=12;fontColor=#1b5e20" edge="1" parent="1" source="step5" target="step1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="500" y="300" as="sourcePoint" />
            <mxPoint x="550" y="250" as="targetPoint" />
            <Array as="points">
              <mxPoint x="700" y="900" />
              <mxPoint x="700" y="140" />
            </Array>
          </mxGeometry>
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
